get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
ncol = 1, rel_heights = c(0.8, 0.1)
)
# title.test <- ggdraw() + draw_label("Predicted and Observed log10 Dk values (Testing)", fontface='bold')
#
# p.test <- plot_grid(p.lm.test.log + theme(legend.position = "none"),
#                 p.svm.test.log + theme(legend.position = "none"),
#                 p.rf.test.log + theme(legend.position = "none"), nrow = 1)
# plot_grid(
#   plot_grid(
#     title.train,
#     p.train,
#     get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   plot_grid(
#     title.test,
#     p.test,
#     get_legend(p.lm.test.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   ncol = 1,
#   labels = c("A", "B")
# )
### Comparison Plot ###
title.train <- ggdraw() + draw_label("Predicted and Observed log10 Dk values", fontface='bold')
p.train <- plot_grid(p.lm.train.log + theme(legend.position = "none"),
p.svm.train.log + theme(legend.position = "none"),
p.rf.train.log + theme(legend.position = "none"), nrow = 1)
plot_grid(
p.train,
get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
ncol = 1, rel_heights = c(0.8, 0.1)
)
# title.test <- ggdraw() + draw_label("Predicted and Observed log10 Dk values (Testing)", fontface='bold')
#
# p.test <- plot_grid(p.lm.test.log + theme(legend.position = "none"),
#                 p.svm.test.log + theme(legend.position = "none"),
#                 p.rf.test.log + theme(legend.position = "none"), nrow = 1)
# plot_grid(
#   plot_grid(
#     title.train,
#     p.train,
#     get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   plot_grid(
#     title.test,
#     p.test,
#     get_legend(p.lm.test.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   ncol = 1,
#   labels = c("A", "B")
# )
### Comparison Plot ###
title.train <- ggdraw() + draw_label("Predicted and Observed log10 Dk values", fontface='bold')
p.train <- plot_grid(p.lm.train.log + theme(legend.position = "none"),
p.svm.train.log + theme(legend.position = "none"),
p.rf.train.log + theme(legend.position = "none"), nrow = 1)
plot_grid(
p.train,
get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
ncol = 1, rel_heights = c(0.8, 0.1)
)
# title.test <- ggdraw() + draw_label("Predicted and Observed log10 Dk values (Testing)", fontface='bold')
#
# p.test <- plot_grid(p.lm.test.log + theme(legend.position = "none"),
#                 p.svm.test.log + theme(legend.position = "none"),
#                 p.rf.test.log + theme(legend.position = "none"), nrow = 1)
# plot_grid(
#   plot_grid(
#     title.train,
#     p.train,
#     get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   plot_grid(
#     title.test,
#     p.test,
#     get_legend(p.lm.test.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   ncol = 1,
#   labels = c("A", "B")
# )
### Comparison Plot ###
title.train <- ggdraw() + draw_label("Predicted and Observed log10 Dk values", fontface='bold')
p.train <- plot_grid(p.lm.train.log + theme(legend.position = "none"),
p.svm.train.log + theme(legend.position = "none"),
p.rf.train.log + theme(legend.position = "none"), nrow = 1)
plot_grid(
p.train,
get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
ncol = 1, rel_heights = c(0.8, 0.1)
)
# title.test <- ggdraw() + draw_label("Predicted and Observed log10 Dk values (Testing)", fontface='bold')
#
# p.test <- plot_grid(p.lm.test.log + theme(legend.position = "none"),
#                 p.svm.test.log + theme(legend.position = "none"),
#                 p.rf.test.log + theme(legend.position = "none"), nrow = 1)
# plot_grid(
#   plot_grid(
#     title.train,
#     p.train,
#     get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   plot_grid(
#     title.test,
#     p.test,
#     get_legend(p.lm.test.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   ncol = 1,
#   labels = c("A", "B")
# )
### Comparison Plot ###
title.train <- ggdraw() + draw_label("Predicted and Observed log10 Dk values", fontface='bold')
p.train <- plot_grid(p.lm.train.log + theme(legend.position = "none"),
p.svm.train.log + theme(legend.position = "none"),
p.rf.train.log + theme(legend.position = "none"), nrow = 1)
plot_grid(
p.train,
get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
ncol = 1, rel_heights = c(0.8, 0.1)
)
# title.test <- ggdraw() + draw_label("Predicted and Observed log10 Dk values (Testing)", fontface='bold')
#
# p.test <- plot_grid(p.lm.test.log + theme(legend.position = "none"),
#                 p.svm.test.log + theme(legend.position = "none"),
#                 p.rf.test.log + theme(legend.position = "none"), nrow = 1)
# plot_grid(
#   plot_grid(
#     title.train,
#     p.train,
#     get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   plot_grid(
#     title.test,
#     p.test,
#     get_legend(p.lm.test.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   ncol = 1,
#   labels = c("A", "B")
# )
### Comparison Plot ###
title.train <- ggdraw() + draw_label("Predicted and Observed log10 Dk values", fontface='bold')
p.train <- plot_grid(p.lm.train.log + theme(legend.position = "none"),
p.svm.train.log + theme(legend.position = "none"),
p.rf.train.log + theme(legend.position = "none"), nrow = 1)
plot_grid(
p.train,
get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
ncol = 1, rel_heights = c(0.8, 0.1)
)
# title.test <- ggdraw() + draw_label("Predicted and Observed log10 Dk values (Testing)", fontface='bold')
#
# p.test <- plot_grid(p.lm.test.log + theme(legend.position = "none"),
#                 p.svm.test.log + theme(legend.position = "none"),
#                 p.rf.test.log + theme(legend.position = "none"), nrow = 1)
# plot_grid(
#   plot_grid(
#     title.train,
#     p.train,
#     get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   plot_grid(
#     title.test,
#     p.test,
#     get_legend(p.lm.test.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   ncol = 1,
#   labels = c("A", "B")
# )
library(ggplot2)
library(cowplot)
library(magick)
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/Figures/modeling paper/"
### Figure 3
dir.names = list.files(figures.path, pattern = "^Figure.*")
for(dir in dir.names){
fig.names = list.files(paste0(figures.path, dir))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
print(fig.names)
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, dir, "/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0(figures.path, "New Figures/", dir, ".jpg"), width = 8, height = 3*length(fig.names)/2)
}
fig.names = list.files(paste0(figures.path, "Figure 3"))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, "Figure 3/", fig.names[i]))
}
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
dir.names = list.files(figures.path, pattern = "^Figure.*")
for(dir in dir.names){
fig.names = list.files(paste0(figures.path, dir))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
print(fig.names)
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, dir, "/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0(figures.path, "New Figures/", dir, ".jpg"), width = 8, height = 3*length(fig.names)/2)
}
library(ggplot2)
library(cowplot)
library(magick)
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
### Figure 3
dir.names = list.files(figures.path, pattern = "^Figure.*")
for(dir in dir.names){
fig.names = list.files(paste0(figures.path, dir))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
print(fig.names)
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, dir, "/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0(figures.path, "New Figures/", dir, ".jpg"), width = 8, height = 3*length(fig.names)/2)
}
fig.names = list.files(paste0(figures.path, "Figure 3"))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, "Figure 3/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0(figures.path, "/Figure 3.jpg"), width = 8, height = 3*length(fig.names)/2)
library(ggplot2)
library(cowplot)
library(magick)
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
### Figure 3
dir.names = list.files(figures.path, pattern = "^Figure.*")
for(dir in dir.names){
fig.names = list.files(paste0(figures.path, dir))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
print(fig.names)
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, dir, "/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0(figures.path, "New Figures/", dir, ".jpg"), width = 8, height = 3*length(fig.names)/2)
}
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
dir.names = list.files(figures.path, pattern = "^Figure.*")
library(ggplot2)
library(cowplot)
library(magick)
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
### Figure 3
dir.names = list.files(figures.path, pattern = "^Figure.*")
for(dir in dir.names){
fig.names = list.files(paste0(figures.path, dir))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
print(fig.names)
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, dir, "/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0(figures.path, dir, ".jpg"), width = 8, height = 3*length(fig.names)/2)
}
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
dir.names = list.files(figures.path, pattern = "^Figure.*")
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
dir.names = list.files(figures.path, pattern = "^Figure.*")
for(dir in dir.names){
fig.names = list.files(paste0(figures.path, dir))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
print(fig.names)
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, dir, "/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0("Figures/", figures.path, dir, ".jpg"), width = 8, height = 3*length(fig.names)/2)
}
library(ggplot2)
library(cowplot)
library(magick)
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
### Figure 3
dir.names = list.files(figures.path, pattern = "^Figure.*")
for(dir in dir.names){
fig.names = list.files(paste0(figures.path, dir))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
print(fig.names)
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, dir, "/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0("Figures/", dir, ".jpg"), width = 8, height = 3*length(fig.names)/2)
}
library(ggplot2)
library(cowplot)
library(magick)
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
### Figure 3
dir.names = list.files(figures.path, pattern = "^Figure.*")
for(dir in dir.names){
fig.names = list.files(paste0(figures.path, dir))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
print(fig.names)
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, dir, "/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0("~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/", dir, ".jpg"), width = 8, height = 3*length(fig.names)/2)
}
fit.lm <- lm(log10(DK) ~ MW + I(log10(CsE)) + CsP + logP, data = train)
train$log10DK_pred <- predict(fit.lm, train)
# Train
drugnames = sort(unique(train$.id))
p.train.log <- ggplot(data = train, aes(x = log10DK, y = log10DK_pred)) +
scale_color_manual(name = "Drug",
labels = drugnames,
values = as.factor(drugnames)) +
scale_shape_manual(name = "Drug",
labels = drugnames,
values=1:7) +
geom_point(aes(shape=.id, col = .id), size = 1) +
geom_abline(intercept = 0, slope = 1, col = "red") +
geom_abline(intercept = -1, slope = 1, col = "blue", linetype = "dashed") +
geom_abline(intercept = 1, slope = 1, col = "blue", linetype = "dashed") +
geom_abline(intercept = -0.5, slope = 1, col = "orange", linetype = "dotdash") +
geom_abline(intercept = 0.5, slope = 1, col = "orange", linetype = "dotdash") +
labs(x = expression(paste("Experimental ",log[10],"(Dk)")),
y = expression(paste("Predicted ",log[10],"(Dk)")),
shape = "Drug")  +
xlim(c(-3,0)) + ylim(c(-3,0)) + theme(aspect.ratio = 1) +
theme_bw()
p.train.log
ggsave(paste0("~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/Figure 2.jpg"),
width = 4, height = 3)
fit.lm <- lm(log10(DK) ~ MW + I(log10(CsE)) + CsP + logP, data = train)
test$log10DK_pred  <- predict(fit.lm, test)
# Test
drugnames = sort(unique(test$.id))
p.test.log <- ggplot(data = test, aes(x = log10DK, y = log10DK_pred)) +
scale_color_manual(name = "Drug",
labels = drugnames,
values = as.factor(drugnames)) +
scale_shape_manual(name = "Drug",
labels = drugnames,
values=7:10) +
geom_point(aes(shape=.id, col = .id), size = 1) +
geom_abline(intercept = 0, slope = 1, col = "red") +
geom_abline(intercept = -1, slope = 1, col = "blue", linetype = "dashed") +
geom_abline(intercept = 1, slope = 1, col = "blue", linetype = "dashed") +
geom_abline(intercept = -0.5, slope = 1, col = "orange", linetype = "dotdash") +
geom_abline(intercept = 0.5, slope = 1, col = "orange", linetype = "dotdash") +
labs(x = expression(paste("Experimental ",log[10],"(Dk)")),
y = expression(paste("Predicted ",log[10],"(Dk)")),
shape = "Drug")  +
xlim(c(-3.5,0)) + ylim(c(-3.5,0)) + theme(aspect.ratio = 1) +
theme_bw()
p.test.log
ggsave(paste0("~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/Figure 4.jpg"),
width = 4, height = 3)
### Plot by drug types ###
fit.lm <- lm(log10(DK) ~ MW + I(log10(CsE)) + CsP + logP, data = train)
data1 <- data0 %>% mutate(log10DK_pred = predict(fit.lm, data0),
DK_pred = 10^log10DK_pred)
draw_pred_plot <- function(id, data1){
data1 <- data1 %>% filter(.id == id)
p <- ggplot(data = data1) +
geom_point(mapping = aes(x = log10DK, y = log10DK_pred), size = 0.8) +
geom_abline(intercept = 0, slope = 1, col = "red") +
geom_abline(intercept = -1, slope = 1, col = "blue", linetype = "dashed") +
geom_abline(intercept = 1, slope = 1, col = "blue", linetype = "dashed") +
geom_abline(intercept = -0.5, slope = 1, col = "orange", linetype = "dotdash") +
geom_abline(intercept = 0.5, slope = 1, col = "orange", linetype = "dotdash") +
labs(title = id,
x = expression(paste("Experimental ",log[10],"(Dk)")),
y = expression(paste("Predicted ",log[10],"(Dk)")),
shape = "Drug")  +
xlim(c(-3.5,0)) + ylim(c(-3.5,0)) + theme(aspect.ratio = 1) +
theme_bw()
return(p)
}
# plot_grid(
#   plot_grid(
#     draw_pred_plot("TAF_base", data1),
#     draw_pred_plot("TAF_salt", data1),
#     draw_pred_plot("LNG", data1),
#     draw_pred_plot("ENG", data1),
#     draw_pred_plot("EFdA", data1),
#     draw_pred_plot("BIC", data1),
#     draw_pred_plot("FTC", data1),
#     ncol = 4
#   ),
#   plot_grid(
#     draw_pred_plot("RAL_salt", data1),
#     draw_pred_plot("DTG", data1),
#     draw_pred_plot("ABC", data1),
#     draw_pred_plot("3TC", data1),
#     ncol = 4
#   ),
#   ncol = 1,
#   labels = c("A", "B"),
#   rel_heights = c(2,1)
# )
plot_grid(
draw_pred_plot("TAFbase", data1),
draw_pred_plot("TAFsalt", data1),
draw_pred_plot("LNG", data1),
draw_pred_plot("ENG", data1),
draw_pred_plot("EFdA", data1),
draw_pred_plot("BIC", data1),
draw_pred_plot("FTC", data1),
ncol = 4
)
ggsave(paste0("~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/Figure S2.jpg"),
width = 11, height = 6)
### Comparison Plot ###
title.train <- ggdraw() + draw_label("Predicted and Observed log10 Dk values", fontface='bold')
p.train <- plot_grid(p.lm.train.log + theme(legend.position = "none"),
p.svm.train.log + theme(legend.position = "none"),
p.rf.train.log + theme(legend.position = "none"), nrow = 1)
plot_grid(
p.train,
get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
ncol = 1, rel_heights = c(0.8, 0.1)
)
ggsave(paste0("~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/Figure S3.jpg"),
width = 11, height = 4.5)
# title.test <- ggdraw() + draw_label("Predicted and Observed log10 Dk values (Testing)", fontface='bold')
#
# p.test <- plot_grid(p.lm.test.log + theme(legend.position = "none"),
#                 p.svm.test.log + theme(legend.position = "none"),
#                 p.rf.test.log + theme(legend.position = "none"), nrow = 1)
# plot_grid(
#   plot_grid(
#     title.train,
#     p.train,
#     get_legend(p.lm.train.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   plot_grid(
#     title.test,
#     p.test,
#     get_legend(p.lm.test.log + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom")),
#     ncol = 1, rel_heights = c(0.1, 0.8, 0.1)
#   ),
#   ncol = 1,
#   labels = c("A", "B")
# )
library(ggplot2)
library(cowplot)
library(magick)
figures.path = "~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/modeling paper/"
### Figure 3
dir.names = list.files(figures.path, pattern = "^Figure.*")
for(dir in dir.names){
fig.names = list.files(paste0(figures.path, dir))
fig.list = list()
labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)")
print(fig.names)
for(i in 1:length(fig.names)){
fig.list[[i]] = ggdraw() +
draw_image(paste0(figures.path, dir, "/", fig.names[i]))
}
plot_grid(plotlist = fig.list,
ncol = 2,
labels = labels[1:length(fig.names)])
ggsave(paste0("~/onedrive/OneDrive - University of North Carolina at Chapel Hill/0. Hudgens Lab/GRA/CFAR/RTI Drug prediction/Figures/", dir, ".jpg"), width = 8, height = 3*length(fig.names)/2)
}
